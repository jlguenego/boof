!function(){"use strict";var t=angular.module("mainApp",["ui.bootstrap","ui.router","jsonFormatter","jlg-menu","jlg-nutritional","jlg-typeahead","jlg-checkbox","jlg-layout","templates"]);angular.module("templates",[]),t.config(["$stateProvider","$urlRouterProvider",function(t,o){o.otherwise("/"),t.state("home",{url:"/",templateUrl:"route/home.html",controller:["$rootScope",function(t){console.log("instantiate home ctrl"),t.nu.aliment=void 0}]}).state("aliment",{url:"/aliment/:alimentURI",templateUrl:"route/aliment.html",controller:["$injector",function(t){var o=t.get("$rootScope"),e=t.get("$stateParams"),n=t.get("$state");return console.log("instantiate aliment ctrl",e),console.log("$stateParams.alimentURI",e.alimentURI),""==e.alimentURI?void console.log("exit from aliment ctrl"):(o.nu.aliment=o.nu.getAlimentFromURI(e.alimentURI),void 0==o.nu.aliment&&n.go("home",{}),void console.log("$rootScope.nu.aliment",o.nu.aliment))}]})}]),t.run(["$injector",function(t){var o=t.get("$rootScope"),e=t.get("$state");o.title="Boof !",o.debug="none",o.cfg=o.cfg||{},o.cfg.isTop=!o.cfg.isMobile,o.$watch("cfg.isTop",function(){if(console.log("watch cfg.isTop"),$("div.jlg-searchbar").removeClass("bottom top"),$("div.jlg-navbar").removeClass("bottom top"),$("jlg-menu").removeClass("bottom top"),o.cfg.isTop){$("div.jlg-navbar").addClass("top"),$("div.jlg-searchbar").addClass("top"),$("jlg-menu").addClass("top");var t=$("#jlg-navbar").detach();$("#layout1").prepend(t)}else{$("div.jlg-navbar").addClass("bottom"),$("div.jlg-searchbar").addClass("bottom"),$("jlg-menu").addClass("bottom");var t=$("#jlg-navbar").detach();$("#layout1").append(t)}}),o.moreResults=function(t){console.log("$rootScope.moreResults",t)},o.home=function(t){$("#body").scrollTop(0),e.go("home",{})},o.$watch("nu.aliment",function(t){if(console.log("watch nu.aliment",t),$("#body").scrollTop(0),void 0!=t){var n=o.nu.getURIFromAliment(o.nu.aliment);e.go("aliment",{alimentURI:n})}else e.go("home",{});$("#body").scrollTop(0)})}]),t.directive("jlgMenu",["$injector",function(t){var o=t.get("$window");return{restrict:"EAC",link:function(t,e,n){var l=function(){console.log("compute Height",t,n);var o=e.parent().height(),l=o-50;e.css("height",l+"px")};angular.element(o).on("resize",l),l()}}}]),t.directive("jlgAutosize",["$injector",function(t){var o=t.get("$rootScope");return{restrict:"EAC",link:function(t,e,n){t.$watch("item",function(){var t=e.text().length,n=16;o.cfg.isMobile&&t>40&&(n=13),e.css("font-size",n+"px")})}}}])}();
!function(){"use strict";var e=angular.module("jlg-menu",["jlg-responsive"]);e.run(["$injector",function(e){e.get("$rootScope")}]),e.controller("jlg-menu.Ctrl",["$injector","$scope",function(e,t){var i=e.get("$templateRequest"),n=e.get("$compile"),l=e.get("$q"),c=angular.element('<div class="jlg-menu-frame"></div>'),r=500,a=function(e,t,i,n){e.css({position:"absolute",top:0,left:t,display:"block"}),jQuery(e).velocity({left:i},r,n)},o=function(e,t,i){return l(function(n,l){a(e,t,i,n)})},s=[];this.initMenu=function(){c.attr("ng-click",this.name+".toggle()"),this.element.append(c),n(c)(t)},this.visible=!1,this.toggle=function(e){this.visible=!this.visible,this.visible&&this.reset()};var u=!0;this.reset=function(){u&&this.open(this.initialPage,this.initialTitle),u=!1},this.open=function(e,l){var r=this;l=l||"Warning: no title!",s.push({templateUrl:e,title:l}),i(e).then(function(e){var i=angular.element('<div class="jlg-menu-panel" ng-click="$event.stopPropagation()"></div>');if(i.append(r.makeTitle(l)),i.append(e),c.append(i),i=c.children().eq(s.length-1),n(i)(t),s.length>1){var a=c.children().eq(s.length-2);o(a,0,-a.width())}return o(i,i.width(),0)}).then(function(){})["catch"](function(e){console.error("error",e)})},this.makeTitle=function(e){var i=angular.element('<div class="jlg-menu-title">'+e+"</div>"),n='<div class="jlg-menu-close"><div class="glyphicon glyphicon-remove" ng-click="'+this.name+'.toggle()"></div></div>',l=angular.element('<div class="jlg-menu-title-bar"></div>');if(s.length>1){var c='<div ng-click="'+this.name+'.back()" class="jlg-menu-back">&lt;Back</div>';l.append(c)}return l.append(i),l.append(n),t.titleDiv=i,l},this.back=function(){var e=c.children().eq(s.length-1),t=c.children().eq(s.length-2);return o(e,0,e.width()),o(t,-t.width(),0).then(function(){c.children().eq(s.length-1).remove(),s.pop()})}}]),e.directive("jlgMenu",["$injector",function(e){e.get("$templateRequest"),e.get("$compile");return{restrict:"EAC",link:function(e,t,i){var n=e[i.ctrl];n.element=t,n.initialPage=i.init,n.initialTitle=i.title,n.name=i.ctrl,n.initMenu()}}}]),e.directive("jlgMenuTitle",["$injector",function(e){e.get("$templateRequest"),e.get("$compile");return{restrict:"EAC",link:function(e,t,i){e.titleDiv.html(i.jlgMenuTitle)}}}]),e.directive("jlgMenuDirectory",["$injector",function(e){e.get("$templateRequest"),e.get("$compile");return{restrict:"EAC",link:function(e,t,i){t.append('<span class="pull-right glyphicon glyphicon-chevron-right"></span>')}}}])}();
!function(){"use strict";var i=angular.module("jlg-responsive",[]);i.run(["$injector",function(i){var e=i.get("$rootScope"),o=i.get("$document");i.get("$window");console.log("jlg-responsive: run"),e.cfg=e.cfg||{},e.cfg.isMobile="ontouchstart"in window,e.cfg.screen=window.screen,e.cfg.window={width:$(window).width(),height:$(window).height()},$(window).on("resize",function(){e.cfg.window.width=$(window).width(),e.cfg.window.height=$(window).height(),e.$apply()}),$(window).on("resize",function(){e.cfg.window.width=$(window).width(),e.cfg.window.height=$(window).height(),e.$apply()});var n=angular.element(o[0].body);e.$watch("cfg.isMobile",function(){n.removeClass("jlg-mobile jlg-desktop"),e.cfg.isMobile?n.addClass("jlg-mobile"):n.addClass("jlg-desktop")})}]),i.controller("jlg-menu.Ctrl",["$injector",function(i){this.visible=!1,this.toggle=function(i){console.log("toggle"),this.visible=!this.visible}}]),i.directive("jlgMenu",["$injector",function(i){i.get("$templateRequest"),i.get("$compile");return{restrict:"EAC",link:function(i,e,o,n){console.log("link jlgMenuLayer",n)}}}])}();
!function(){"use strict";var t=angular.module("jlg-nutritional",["jlg-misc"]);t.run(["$injector",function(t){var a=t.get("$rootScope"),e=t.get("$http"),i=t.get("misc");console.log("jlg-nutritional: run"),a.nu={},a.nu.aliment=void 0,a.nu.aliments=[],a.nu.alimentURIMap={},a.nu.getURIFromAliment=function(t){console.log("getURIFromAliment with ",t);var n=i.niceURI(t);return console.log("returning ",n),n},a.nu.getAlimentFromURI=function(t){return a.nu.alimentURIMap[t]},e.get("jlg-nutritional/data.csv").then(function(t){a.csv=Papa.parse(t.data,{header:!0}),a.csv.data=a.csv.data.filter(function(t){return void 0!=t.ORIGFDNM}),a.nu.aliments=a.csv.data.map(function(t){return t.ORIGFDNM}).sort(),a.nu.aliments.forEach(function(t){var n=i.niceURI(t);a.nu.alimentURIMap[n]&&console.warn("collision in alimentURIMap: ",t,a.nu.alimentURIMap[n]),a.nu.alimentURIMap[n]=t}),a.$watch("nu.aliment",function(){a.nu.alimentData=a.csv.data.find(function(t){return t.ORIGFDNM===a.nu.aliment}),console.log("$rootScope.nu.aliment",a.nu.aliment),console.log("$rootScope.nu.alimentData",a.nu.alimentData),a.nu.alimentDataTable=n(a.nu.alimentData)})})["catch"](function(t){console.error("error",t)})}]);var n=function(t){var n=[];for(var a in t)n.push({key:a,value:t[a]});return n.sort(function(t,n){return t.key>n.key?-1:1})};t.directive("jlgNutritionalTable",["$injector",function(t){t.get("$compile"),t.get("$q");return console.log("jlgNutritionalTable start"),{restrict:"EAC",scope:!0,template:'<table ng-show="nu.alimentDataTable.length > 0" class="table-hover table-striped"><tr><th>Nutriment</th><th>Value</th></tr><tr ng-repeat="a in nu.alimentDataTable"><td>{{a.key}}</td><td>{{a.value}}</td></tr></table>'}}])}();
!function(){"use strict";var e=angular.module("jlg-typeahead",["jlg-responsive"]);e.run(["$injector",function(e){e.get("$rootScope")}]),e.directive("jlgTypeahead",["$injector",function(e){var t=e.get("$compile"),o=(e.get("$q"),e.get("filterFilter")),i=e.get("$rootScope");e.get("$templateRequest");return{require:"ngModel",restrict:"EAC",scope:{source:"=source",value:"=ngModel"},link:function(e,l,n,s){console.log("link jlgTypeahead",e,l,n,s),e.isInputVisible=!0,e.isPopupVisible=!1,e.isMouseInPopup=!1,e.inputValue=void 0,e.activeItem=void 0,e.filteredList=void 0;var a=angular.element('<div ng-hide="isInputVisible" class="jlg-typeahead-tag"><span>{{value}}<span class="remove" ng-click="remove()">x</span></span></div>');l.append(a),t(a)(e);var u=angular.element('<input ng-show="isInputVisible" class="jlg-typeahead-input" ng-model="inputValue"/>');u.attr("ng-model-options",n.ngModelOptions),u.attr("placeholder",n.placeholder),u.attr("autocomplete","off"),l.append(u),t(u)(e);var p=n.template?n.template:"jlg-typeahead/tmpl/popup-item.html",c=angular.element('<div ng-show="isPopupVisible" class="jlg-typeahead-popup"></div>');c.append('<div ng-repeat="$item in source | filter: inputValue track by $index" ng-click="selectItem()" jlg-active><span ng-include="\''+p+"'\"></span></div>"),c.append('<div ng-show="noResultFound" class="noResultFound">Aucun résultat trouvé</div>'),console.log("popup",c);var r=n.popup?$(n.popup):l;r.append(c),t(c)(e),u.on("focus",function(){i.cfg.isMobile?(console.log("focus isMobile"),e.inputValue=""):(console.log("focus isMobile false"),$(this).select()),void 0==e.inputValue&&(e.inputValue=""),void 0==e.activeItem&&(e.activeItem=0),e.isPopupVisible=!0,e.$apply()}),u.on("blur",function(){console.log("input blur",e.isMouseInPopup),e.isMouseInPopup||(e.doNotRemovePopup?delete e.doNotRemovePopup:e.isPopupVisible=!1,e.$apply())}),c.on("mouseenter",function(){e.isMouseInPopup=!0,e.$apply()}),c.on("mouseleave",function(){e.isMouseInPopup=!1,e.$apply()}),c.on("touchstart",function(){i.debug="touchstart",e.doNotRemovePopup=!0,u.blur(),e.$apply()}),e.$watch("activeItem",function(e,t){c.children().eq(e).addClass("active"),c.children().eq(t).removeClass("active")}),e.$watch("inputValue",function(t,i){e.filteredList=o(e.source,t),e.noResultFound=0==e.filteredList.length,e.isLongList=e.filteredList.length>8,e.isLongList?c.addClass("longlist"):c.removeClass("longlist")}),e.selectItem=function(){console.log("selectItem",e,s),console.log("about to set ",e.activeItem),console.log("about to set ",e.filteredList[e.activeItem]),s.$setViewValue(e.filteredList[e.activeItem]),s.$commitViewValue(),e.isPopupVisible=!1,e.isInputVisible=!1,u.val(""),u.trigger("input"),l.addClass("tag-visible"),n.onSelectItem&&e.$parent.$eval(n.onSelectItem)},e.remove=function(){console.log("close",e,s),s.$setViewValue(void 0),s.$commitViewValue(),e.isInputVisible=!0,e.isPopupVisible=!1,l.removeClass("tag-visible")},e.$watch("value",function(t,o){console.log("watch value",t,o),void 0!=o&&void 0==t&&(console.log("watch value: about to remove"),e.remove())})}}}]),e.directive("jlgActive",["$injector",function(e){return{restrict:"A",link:function(e,t,o){var i=function(){e.$parent.activeItem=e.$index,e.$apply()};t.bind("mouseenter",i),t.bind("touchstart",i)}}}])}();
!function(){"use strict";var e=angular.module("jlg-checkbox",[]);e.run(function(){FastClick.attach(document.body)}),e.directive("jlgCheckbox",["$injector",function(e){var c=e.get("$compile");return{restrict:"EAC",link:function(e,n,t,l){var a=t.ngModel,i=angular.element("<div ng-click=\"switch('"+a+'\')" id="jlg-checkbox-'+a+'" class="jlg-checkbox-div"><span></span></div>');c(i)(e),n.after(i);var o=0,r=2,s=12,u=function(e,c,n,t){return e.css({left:r}),jQuery(e).velocity({left:n},o,t),function(c){c&&e.stop()}};e["switch"]=function(c){var n=e.$eval(c);n?e.$eval(c+" = false"):e.$eval(c+" = true"),e.set(c)},e.set=function(c){var n=c.replace(/(:|\.|\[|\]|,)/g,"\\$1"),t=angular.element("#jlg-checkbox-"+n+" span");e.$eval(c)?u(t,r,s,function(){t.addClass("glyphicon glyphicon-ok")}):(t.removeClass("glyphicon glyphicon-ok"),u(t,s,r))},e.$watch(a,function(){e.set(a)}),e.set(a)}}}])}();
!function(){"use strict";var e=angular.module("jlg-layout",[]);e.run(function(){}),e.directive("jlgLayout",["$injector",function(e){var n=e.get("$window");return{restrict:"ECA",require:"jlgLayout",scope:{cfg:"=jlgLayout"},link:function(e,o,t,i){console.log("jlgLayout",arguments),console.log("containers",i.containers);var c=function(){console.log("refresh"),o.contents().filter(function(){return 3==this.nodeType}).remove();var n=0,t="row"==e.cfg.flow,c=t?o.height():o.width(),r=t?"height":"width",s=t?"width":"height";i.containers.forEach(function(e,o){e.element.css(s,"100%");var i=t?"block":"inline-block";if(e.element.css("display",i),void 0!=e.cfg.size){var c=parseInt(e.cfg.size);n+=c,e.element.css(r,c+"px")}}),i.containers.forEach(function(e,o){if(void 0==e.cfg.size){var t=(c-n)/i.unspecifiedSizeCounter;e.element.css(r,t+"px")}})};angular.element(n).on("resize",c),e.$watch("cfg",c,!0),c()},controller:["$scope","$injector",function(e,n){console.log("instanciation of the jlgLayout container. Scope=",e),this.containers=[],this.unspecifiedSizeCounter=0}]}}]),e.directive("jlgLayoutContainer",["$injector",function(e){return{restrict:"ECA",require:"^jlgLayout",scope:{cfg:"=jlgLayoutContainer"},link:function(e,n,o,t){console.log("jlgLayoutContainer",arguments);var i={};console.log("scope.cfg",e.cfg),void 0!=e.cfg&&(i=e.cfg),void 0==i.size&&t.unspecifiedSizeCounter++;var c={cfg:i,element:n};t.containers.push(c)}}}])}();
!function(){function e(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return s[e]||e})}for(var t=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],s={},a=0;a<t.length;a++)for(var r=t[a].letters,l=0;l<r.length;l++)s[r[l]]=t[a].base;var b=function(t){var s=e(t).replace(/[^a-zA-Z0-9]+/g,"-");return encodeURI(s)},n=angular.module("jlg-misc",[]);n.value("misc",{niceURI:b,removeDiacritics:e})}();